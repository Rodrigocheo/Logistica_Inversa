<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registro Komatsu</title>
</head>
<body style="font-family: Arial; padding: 20px;">
  <h2 style="text-align: center;">Registro de productos - Komatsu</h2>

  <input type="text" id="codigo" placeholder="Escanea o escribe código" style="width: 100%; padding: 10px; font-size: 18px;" />

  <button onclick="registrar()" style="width: 100%; padding: 10px; margin-top: 10px; font-size: 18px;">Guardar</button>

  <p id="mensaje" style="color: green; display: none; text-align: center; font-weight: bold;">✔️ Registrado correctamente</p>

  <script>
    const API_BASE = "https://logistica-inversa.onrender.com";

    function registrar() {
      const codigo = document.getElementById("codigo").value.trim();
      if (!codigo) return;

      const data = {
        codigo: codigo,
        descripcion: "",  // si luego quieres eliminarlo del backend, lo puedes quitar
        cantidad: 1
      };

      fetch(`${API_BASE}/post-scan`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      })
      .then(response => {
        if (response.ok) {
          document.getElementById("codigo").value = "";
          const mensaje = document.getElementById("mensaje");
          mensaje.style.display = "block";
          setTimeout(() => mensaje.style.display = "none", 2000);
        }
      })
      .catch(error => {
        console.error("Error al guardar:", error);  // sin alert
      });
    }
  </script>
</body>
</html>
